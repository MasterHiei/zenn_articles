---
title: "Flutterã®ã‚¢ã‚»ãƒƒãƒˆã‚’æ¥½ã«ä½¿ã†"
emoji: "ğŸ¥º"
type: "tech"
topics: ["Flutter", "Dart", "flutter_gen"]
published: true
---
# å¾“æ¥ã®ã‚¢ã‚»ãƒƒãƒˆç®¡ç†

Flutterã‚¢ãƒ—ãƒªã®é–‹ç™ºã§ã€ãƒ­ãƒ¼ã‚«ãƒ«ã«ä¿å­˜ã—ãŸç”»åƒã‚’è¡¨ç¤ºã™ã‚‹ã“ã¨ãŒå¤šã„ã§ã™ã€‚

ãã®ã¨ãã€ä»¥ä¸‹ã®ã‚ˆã†ã«å®Ÿè£…ã™ã‚‹ã®ã¯ä¸€èˆ¬çš„ã ã¨æ€ã„ã¾ã™ã€‚

```yaml
# pubspec.yaml
flutter:
  assets:
    - assets/images/avatar.jpg
```

```dart
Widget build(BuildContext context) {
  return Image.asset('assets/images/avatar.jpg');
}
```

ã—ã‹ã—ã€ã“ã®æ–¹æ³•ã«ã¯ã„ãã¤ã‹ã®å•é¡Œç‚¹ãŒã‚ã‚Šã¾ã™ã€‚

- ã‚¿ã‚¤ãƒ—ãƒŸã‚¹ã‚„å­˜åœ¨ã—ãªã„ãƒªã‚½ãƒ¼ã‚¹ã¸ã®å‚ç…§
- é–‹ç™ºåŠ¹ç‡ã‚„å¯èª­æ€§ã®ä½ä¸‹

ãƒªã‚½ãƒ¼ã‚¹ã®ãƒ‘ã‚¹ã‚’æ›¸ãé–“é•ãˆãŸã‚Šã€`pubspec.yaml`ã®è¨­å®šã‚’å¿˜ã‚ŒãŸã‚Šã—ãŸã¨ã—ã¦ã‚‚ã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãªã„ã®ã§ã€ãƒã‚°ã£ãŸã“ã¨ã‚’æ°—ã¥ã‹ãªã„ã¾ã¾ãƒªãƒªãƒ¼ã‚¹ã—ã¦ã—ã¾ã†å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

ã“ã®ãƒªã‚¹ã‚¯ã‚’è§£æ¶ˆã™ã‚‹ãŸã‚ã«ã€`flutter_gen`ã¨ã„ã†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã”ç´¹ä»‹ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚

# FlutterGenã¨ã¯

[flutter_gen](https://pub.dev/packages/flutter_gen)ã¯ã€`R.java`ã‚„`R.swift`ã®ã‚ˆã†ãªã€ç”»åƒã€ãƒ•ã‚©ãƒ³ãƒˆã€ã‚«ãƒ©ãƒ¼ãªã©ã®ãƒªã‚½ãƒ¼ã‚¹ã¸å®‰å…¨ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã®ã‚³ãƒ¼ãƒ‰è‡ªå‹•ç”Ÿæˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™[^1]ã€‚

## å°å…¥

- Homebrew(macOS and Linux)

```bash
$ brew install FlutterGen/tap/fluttergen
```

- Dart package(macOS, Linux and Windows)

```bash
$ dart pub global activate flutter_gen
```

- Flutter package

```yaml
# pubspec.yaml
dev_dependencies:
  build_runner:
  flutter_gen_runner:
```

## è¨­å®š

ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®è¨­å®šå€¤ã¯ä»¥ä¸‹ã«ãªã‚Šã¾ã™ã€‚

```yaml
# pubspec.yaml
# ...

flutter_gen:
  # Optional
  output: lib/gen/
  # Optional
  line_length: 80

  # Optional
  integrations:
    flutter_svg: false
    flare_flutter: false
    rive: false
    lottie: false

  assets:
    # Optional
    enabled: true
    # Optional
    outputs:
      # Optional
      # Set to true if you want this package to be a package dependency
      # See: https://flutter.dev/docs/development/ui/assets-and-images#from-packages
      package_parameter_enabled: false
      # Optional
      # Available values:
      # - camel-case
      # - snake-case
      # - dot-delimiter
      style: dot-delimiter
      class_name: Assets
    # Ignore unwanted files
    exclude: []

  fonts:
    # Optional
    enabled: true
    # Optional
    outputs:
      class_name: FontFamily

  colors:
    # Optional
    enabled: true
    # Optional
    inputs: []
    # Optional
    outputs:
      class_name: ColorName
```

`pubspec.yaml`ã«`flutter_gen`ã®è¨­å®šã‚’è¿½åŠ ã—ã¦ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã§ãã¾ã™ã€‚

ä¾‹ãˆã°ã€SVGç”»åƒã‚’è¡¨ç¤ºã—ãŸã„å ´åˆã¯ä»¥ä¸‹ã‚ˆã†ã«è¨­å®šã—ã¾ã™ã€‚

```yaml
# pubspec.yaml
# ...

flutter_gen:
  integrations:
    # flutter_svgã‚’åˆ©ç”¨ã—ã¾ã™
    # https://pub.dev/packages/flutter_svg
    flutter_svg: true

flutter:
  # ...

  assets:
    - assets/images/avatar.svg
```

## ç”Ÿæˆ

1. ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
```bash
$ flutter pub get
```

2. ã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆ
```bash
$ flutter pub run build_runner build --delete-conflicting-outputs
```

## ä½¿ç”¨

- ç”»åƒ

```dart
Widget build(BuildContext context) {
  return Assets.images.avatar.image(
    width: 120,
    height: 120,
    fit: BoxFit.scaleDown,
  );
}

Widget build(BuildContext context) {
  // Same as Image.asset('assets/images/avatar.jpg')
  return Image.asset(Assets.images.avatar.path);
}

Widget build(BuildContext context) {
  // Use flutter_svg
  return Assets.images.avatar.svg(
    width: 120,
    height: 120,
    fit: BoxFit.scaleDown,
  );
}
```

- ãƒ•ã‚©ãƒ³ãƒˆ

```yaml
flutter:
  # ...

  fonts:
    - family: MyFont
      fonts:
        - asset: fonts/MyFont-Regular.ttf
        - asset: fonts/MyFont-Bold.ttf
```

```dart
ThemeData(
  fontFamily: FontFamily.myFont,
)
```

## æ—¢çŸ¥ã®å•é¡Œ

### Bad state: No element

`build_runner`ã‚’å®Ÿè¡Œã—ãŸã‚‰`Bad state: No element`ã¨ã„ã†ã‚¨ãƒ©ãƒ¼ãŒå‡ºã¦å¤±æ•—ã—ã¾ã™ã€‚

`build.yaml`ã‚’ä½œæˆã—ã¦`build_runner`ã®è¨­å®šã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã™ã‚‹ã¨ç™ºç”Ÿã—ã¾ã™ã€‚

ã“ã®å ´åˆã€`build.yaml`ã«`pubspec.yaml`ã®ä¾é ¼ã‚’è¿½åŠ ã™ã‚Œã°ã‚¨ãƒ©ãƒ¼ã‚’è§£æ¶ˆã§ãã¾ã™ã€‚

```yaml
targets:
  $default:
    sources:
      include:
        - pubspec.yaml  # add this line
```

### Bad state: Unable to generate package graph

`pubspec.yaml`ã«`generate: true`ã‚’è¨­å®šã—ã¦ã„ã‚‹ã“ã¨ãŒåŸå› ã§ã€å‰Šé™¤ã™ã‚Œã°ã‚¨ãƒ©ãƒ¼ã‚’è§£æ¶ˆã§ãã¾ã™ã€‚

```yaml
# pubspec.yaml
flutter:
  generate: true <--- âš ï¸Remove this lineâš ï¸
```

Flutterã®å¤šè¨€èªå¯¾å¿œã‚’å…¥ã‚Œã¦ã„ã‚‹å ´åˆã€`l10n.yaml`ã«`synthetic-package: false`ã‚’è¨­å®šã™ã‚‹å¿…è¦ã‚‚ã‚ã‚Šã¾ã™ã€‚

```yaml
# l10n.yaml
arb-dir: lib/l10n
template-arb-file: app_en.arb
output-localization-file: app_localizations.dart
synthetic-package: false <--- âš ï¸Add this lineâš ï¸
```

# æœ€å¾Œã«

FlutterGenã‚’å°å…¥ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€ç”»åƒãªã©ã®ã‚¢ã‚»ãƒƒãƒˆã‚’å®‰å…¨ã‹ã¤ä¾¿åˆ©ã«ç®¡ç†ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

ã“ã‚Œã‹ã‚‰ã‚‚Flutteré–‹ç™ºã‚’æ¥½ã—ã‚“ã§ã„ãã¾ã—ã‚‡ã†ã€‚

[^1]: è©³ã—ã„å†…å®¹ã¯ã€ãƒ©ã‚¤ãƒ–ãƒ©ãƒªä½œè€…ã®[è¨˜äº‹](https://zenn.dev/wasabeef/articles/64f93fcb1673b934c85b)ã‚’ãŠèª­ã¿ãã ã•ã„ã€‚
