---
title: "riverpod_generatorã§ä¾å­˜æ€§æ³¨å…¥(DI)"
emoji: "ğŸ‘"
type: "tech"
topics: ["Flutter", "riverpod", "di"]
publication_name: "minma"
published: true
---
# ã¯ã˜ã‚ã«

[riverpod_generator](https://pub.dev/packages/riverpod_generator)ã‚’å°å…¥ã™ã‚‹ã¨ã€å„providerã®æ›¸ãæ–¹ãŒå¤§ããå¤‰ã‚ã£ã¦ã—ã¾ã†ã®ã§ã€ãã®å ´åˆã§ä¾å­˜æ€§æ³¨å…¥(DI)ã‚’æ§‹ç¯‰ã™ã‚‹æ–¹æ³•ã‚’ç´¹ä»‹ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚

# è¨˜äº‹ã®å¯¾è±¡è€…

- ä¾å­˜æ€§æ³¨å…¥(DI)ã«é¦´æŸ“ã¿ã®ã‚ã‚‹æ–¹

- riverpodã§ä¾å­˜æ€§æ³¨å…¥ã‚’æ§‹ç¯‰ã—ãŸã„æ–¹

- riverpod_generatorã‚’åˆ©ç”¨ã—ãŸã„æ–¹

# riverpodã«ãŠã‘ã‚‹DI

ãã®å‰ã«ã€ã¾ãšã¯`riverpod`ã®ã¿ã§ä¾å­˜æ€§æ³¨å…¥ã‚’ã‚„ã£ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

## å®Ÿè£…ä¾‹

```dart
final engineAProvider = Provider<Engine>((_) => EngineA());
final engineBProvider = Provider<Engine>((_) => EngineB());

abstract class Engine {
  void start() {}
}
class EngineA implements Engine {
  @override
  void start() {
    debugPrint('Engine A started.');
  }
}
class EngineB implements Engine {
  @override
  void start() {
    debugPrint('Engine B started.');
  }
}

final carAProvider = Provider((ref) => Car(engine: ref.watch(engineAProvider)));
final carBProvider = Provider((ref) => Car(engine: ref.watch(engineBProvider)));

class Car {
  const Car({required this.engine});

  final Engine engine;

  void drive() {
    engine.start();
  }
}
```

### å®Ÿè¡Œçµæœ

```dart
// Print: Engine A started.
ref.read(carAProvider).drive();

// Print: Engine B started.
ref.read(carBProvider).drive();
```

ä¸Šè¨˜ã®é€šã‚Šã€Providerã§`Engine`ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’æä¾›ã—ã¦`Car`ã«æ¸¡ã—ã¦ã„ã¾ã™ã€‚

`Engine`ã‚’ç”Ÿæˆã™ã‚‹Providerã‚’å¤‰ãˆã‚‹ã“ã¨ã§ã€ç•°ãªã‚‹`Engine`ã‚’æŒã¤`Car`ã‚’ä½œã‚‹ã“ã¨ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚

ã“ã®ã‚ˆã†ã«DIã‚’è¡Œã†ã“ã¨ã§ã€ãƒ†ã‚¹ãƒˆãŒå®¹æ˜“ã«ãªã‚Šã€å¤‰åŒ–ã«å¼·ã„ã‚¢ãƒ—ãƒªã‚’ä½œã‚Šã‚„ã™ããªã‚Šã¾ã™ã€‚

# riverpod_generatorã‚’åˆ©ç”¨ã—ãŸDI

ã•ãƒ¼ã¦ã€`riverpod_generator`ã®å ´åˆã¯ã©ã†ã™ã‚Œã°è‰¯ã„ã®ã§ã—ã‚‡ã†ã‹ï¼Ÿ

## å®Ÿè£…ä¾‹

```dart
abstract class Engine {
  void start() {}
}

@Riverpod(keepAlive: true)
class EngineA extends _$EngineA implements Engine {
  @override
  Engine build() => this;

  @override
  void start() {
    debugPrint('Engine A started');
  }
}
@Riverpod(keepAlive: true)
class EngineB extends _$EngineB implements Engine {
  @override
  Engine build() => this;

  @override
  void start() {
    debugPrint('Engine B started');
  }
}

@Riverpod(keepAlive: true)
Car carA(CarARef ref) => Car(engine: ref.watch(engineAProvider));
@Riverpod(keepAlive: true)
Car carB(CarBRef ref) => Car(engine: ref.watch(engineBProvider));

class Car {
  const Car({required this.engine});

  final Engine engine;

  void drive() {
    engine.start();
  }
}
```

### å®Ÿè¡Œçµæœ

```dart
// Print: Engine A started.
ref.read(carAProvider).drive();

// Print: Engine B started.
ref.read(carBProvider).drive();
```

`EngineA`ã€`EngineB`ãã‚Œãã‚Œã‚’ProviderClassã«å¤‰æ›´ã—ã€`CarA`ã¨`CarB`ã‚’ç”Ÿæˆã™ã‚‹Providerã‚’å†ä½œæˆã—ã¾ã™ã€‚

ãã‚Œã§ã€ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã™ã‚‹å‰ã¨å…¨ãåŒã˜ä»•çµ„ã¿ã‚’ä½œã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚

# ã•ã„ã”ã«

ã“ã®è¨˜äº‹ã§ã¯ã€`riverpod_generator`ã‚’åˆ©ç”¨ã—ãŸä¾å­˜æ€§æ³¨å…¥(DI)ã‚’æ§‹ç¯‰ã™ã‚‹æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã—ãŸã€‚

ç¾æ™‚ç‚¹ã§`riverpod_generator`ã¯optionã®æ‰±ã„ã«ãªã‚‹ã®ã§ã™ãŒã€ä½œè€…ã®Remiã•ã‚“ã¯

> `riverpod_generator`ã¯æœªæ¥ã«å‘ã‘ãŸä»•çµ„ã¿ã§ã€å°‘ã—ä¸ä¾¿ãªã¨ã“ã‚ã‚‚ã‚ã‚‹ã®ã§ã™ãŒä½¿ã†ã®ã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚

ã¨[è¿°ã¹ã¦ã„ã‚‹](https://riverpod.dev/docs/concepts/about_code_generation#should-i-use-code-generation)ãŸã‚ã€æœªæ¥ã«å‚™ãˆã¦ã©ã‚“ã©ã‚“ä½¿ã£ã¦ã„ãã¾ã—ã‚‡ã†ã€‚
