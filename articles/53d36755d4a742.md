---
title: "Flutter Windowsã‚¢ãƒ—ãƒªçµ‚äº†æ™‚ã«ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤ºã™ã‚‹æ–¹æ³•"
emoji: "ğŸ‘"
type: "tech"
topics: ["Flutter", "Windows", "window_manager"]
publication_name: "minma"
published: true
---
# ã¯ã˜ã‚ã«

ä»Šå›ã¯ã€Flutterã®Windowsã‚¢ãƒ—ãƒªã‚’é–‰ã˜ã‚‹ã¨ãã«ã€ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤ºã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦ã‚’æ›¸ã„ã¦ã¿ã‚ˆã†ã¨æ€ã„ã¾ã™ã€‚

# æº–å‚™ã™ã‚‹ã“ã¨

`pubspec.yaml`ãƒ•ã‚¡ã‚¤ãƒ«ã«ã€[window_manager](https://pub.dev/packages/window_manager)ã¨ã„ã†ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```yaml
# pubspec.yaml
dependencies:
  window_manager: ^0.3.6
```

# å®Ÿè£…

ã¾ãšã¯ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®åˆæœŸåŒ–å‡¦ç†ã‚’è¡Œã„ã¾ã™ã€‚

```dart
// main.dart
void main() async {
  WidgetsFlutterBinding.ensureInitialized();

  // åˆæœŸåŒ–
  await windowManager.ensureInitialized();
  windowManager.waitUntilReadyToShow(
    const WindowOptions(),
    () async {
      // OSã®é–‰ã˜ã‚‹å‡¦ç†ã‚’ç„¡åŠ¹ã«ã™ã‚‹
      await windowManager.setPreventClose(true);
    },
  );

  runApp(const MyApp());
}
```

ãã—ã¦å¯¾å¿œã—ãŸã„ç”»é¢ã«ã€ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã—ãŸé–‰ã˜ã‚‹å‡¦ç†ã‚’å®Ÿè£…ã—ã¾ã™ã€‚


```dart
class MyHomePage extends StatefulWidget {
  const MyHomePage({super.key});

  @override
  State<MyHomePage> createState() => _MyHomePageState();
}

class _MyHomePageState extends State<MyHomePage> with WindowListener {
  @override
  void initState() {
    super.initState();
    // ãƒªã‚¹ãƒŠãƒ¼ã‚’è¿½åŠ ã™ã‚‹å‡¦ç†
    windowManager.addListener(this);
  }

  @override
  void dispose() {
    // ãƒªã‚¹ãƒŠãƒ¼ã‚’è§£é™¤ã™ã‚‹å‡¦ç†
    windowManager.removeListener(this);
    super.dispose();
  }

  @override
  void onWindowClose() {
    // ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤ºã™ã‚‹
    showDialog(
      context: context,
      builder: (context) => AlertDialog(
        title: const Text('ã‚¢ãƒ—ãƒªã‚’é–‰ã˜ã¾ã™ã‹ï¼Ÿ'),
        actions: [
          TextButton(
            onPressed: () => Navigator.pop(context),
            child: const Text('ã„ã„ãˆ'),
          ),
          TextButton(
            onPressed: windowManager.destroy, // æ‰‹å‹•ã§ç”»é¢ã‚’é–‰ã˜ã‚‹å‡¦ç†ã‚’å®Ÿè¡Œ
            child: const Text('ã¯ã„'),
          ),
        ],
      ),
    );
  }

  @override
  Widget build(BuildContext context) {
    return const Scaffold(
      body: YourWidget(),
    );
  }
}
```

å®Ÿéš›ã«å‹•ã‹ã—ã¦ã¿ãŸæ§˜å­ã¯ä»¥ä¸‹ã®ã‚¹ã‚¯ã‚·ãƒ§ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

ã‚¢ãƒ—ãƒªã®å³ä¸Šã®ã€ŒXã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

æ¬¡ã«ã€Œã¯ã„ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸã‚‰ã€ã‚¢ãƒ—ãƒªãŒé–‰ã˜ã‚‰ã‚Œã¾ã™ã€‚

![done](https://storage.googleapis.com/zenn-user-upload/f4c1c6c51909-20230910.png)

# æœ€å¾Œã«

ä»Šå›ã¯`window_manager`ã‚’åˆ©ç”¨ã—ã¦ã€Windowsã‚¢ãƒ—ãƒªã‚’é–‰ã˜ã‚‹å‡¦ç†ã‚’æ‰‹å‹•ã§ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã™ã‚‹æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã—ãŸã€‚

å®Ÿã¯ãã‚Œä»¥å¤–ã«ã€`window_manager`ã¯ç”»é¢ã®UIã‚„æœ€å¤§åŒ–/æœ€å°åŒ–ãªã©ã€ã„ã‚ã‚“ãªè¨­å®šã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

Flutterã§Windowsã‚¢ãƒ—ãƒªã‚’ä½œã‚‹éš›ã«ã€ã“ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã§ãã‚Œã°é–‹ç™ºã¯æ¥½ã«ãªã‚‹ã‹ãªã¨æ€ã„ã¾ã™ã€‚

ã”å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚
